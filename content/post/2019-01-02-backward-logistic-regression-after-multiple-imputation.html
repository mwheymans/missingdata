---
title: "Logistic Regression after Multiple Imputation - different selection criteria"
author: "Martijn Heymans"
date: '2019-01-02'
slug: backward-logistic-regression-after-multiple-imputation
output:
    blogdown::html_page
tags:
- psfmi
- Multiple Imputation
- backward selection
- logistic regression
- pooling 
- D1
- D2
- Meng and Rubin
- Rubins Rules
thumbnailImagePosition: left
thumbnailImage: "/images/different_selection_criteria.jpg"
description: With the [psfmi](/psfmi/) package it is possible to do backward selection for logistic regression models after Multiple Imputation (MI). For backward selection, several variable selection criteria can be used. These criteria are called the D1, D2, D3 and Median P-rule (MPR).

---



<p>The different methods are described in the papers of <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/1471-2288-9-57">Marshall et al</a> and <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-017-0404-7">Eekhout, vd Wiel and Heymans</a>.</p>
<p>Be aware that backward selection may result in overfitted and optimistic prediction models, see <a href="http://annals.org/aim/fullarticle/2088542/transparent-reporting-multivariable-prediction-model-individual-prognosis-diagnosis-tripod-explanation">TRIPOD</a>. Backward selection should therefore be followed by internal validation of the model.</p>
<div id="examples" class="section level2">
<h2>Examples</h2>
<ul>
<li><a href="#pooling-without-bs-and-method-d1">Pooling without BS and method D1</a></li>
<li><a href="#pooling-with-bs-and-method-d3">Pooling with BS and method D3</a></li>
</ul>
</div>
<div id="logistic-regression" class="section level2">
<h2>Logistic Regression</h2>
<div id="pooling-without-bs-and-method-d1" class="section level3">
<h3>Pooling without BS and method D1</h3>
<pre class="r"><code>library(psfmi)
pool_lr &lt;- psfmi_lr(data=lbpmilr, nimp=5, impvar=&quot;Impnr&quot;, Outcome=&quot;Chronic&quot;,
         predictors=c(&quot;Gender&quot;, &quot;Smoking&quot;, &quot;Function&quot;, &quot;JobControl&quot;,
                      &quot;JobDemands&quot;, &quot;SocialSupport&quot;), method=&quot;D1&quot;)</code></pre>
<pre><code>## 
## Pooled model correctly estimated
##            using a p-value of 1</code></pre>
<pre class="r"><code>pool_lr$RR_Model</code></pre>
<pre><code>## $`Step 1`
##                   est std.err signif   lower   upper     OR   L.OR
## (Intercept)    1.1637  2.2828 0.6102 -3.3104  5.6379 3.2018 0.0365
## Gender        -0.4220  0.4073 0.3001 -1.2202  0.3762 0.6557 0.2952
## Smoking        0.1164  0.3407 0.7327 -0.5515  0.7842 1.1234 0.5761
## Function      -0.1457  0.0421 0.0005 -0.2282 -0.0632 0.8644 0.7959
## JobControl     0.0021  0.0191 0.9145 -0.0355  0.0396 1.0021 0.9652
## JobDemands    -0.0087  0.0357 0.8065 -0.0787  0.0612 0.9913 0.9243
## SocialSupport  0.0249  0.0540 0.6449 -0.0810  0.1308 1.0252 0.9222
##                   U.OR
## (Intercept)   280.8649
## Gender          1.4568
## Smoking         2.1907
## Function        0.9387
## JobControl      1.0404
## JobDemands      1.0632
## SocialSupport   1.1397</code></pre>
<pre class="r"><code>pool_lr$multiparm_p</code></pre>
<pre><code>## $`Step 1`
##               Chi_sq D1 &amp; RR p-values
## Gender         1.074           0.3001
## Smoking        0.117           0.7327
## Function      11.984           0.0005
## JobControl     0.012           0.9145
## JobDemands     0.060           0.8065
## SocialSupport  0.212           0.6449</code></pre>
<p>Back to <a href="#examples">Examples</a></p>
</div>
<div id="pooling-with-bs-and-method-d3" class="section level3">
<h3>Pooling with BS and method D3</h3>
<p>Pooling Logistic regression models over 5 imputed datasets with backward selection
using a p-value of 0.05 and as method D3 (Meng and Rubin likelihood ratio statistics).</p>
<pre class="r"><code>library(psfmi)
pool_lr &lt;- psfmi_lr(data=lbpmilr, nimp=5, impvar=&quot;Impnr&quot;, Outcome=&quot;Chronic&quot;,
         predictors=c(&quot;Gender&quot;, &quot;Smoking&quot;, &quot;Function&quot;, &quot;JobControl&quot;,
                      &quot;JobDemands&quot;, &quot;SocialSupport&quot;), p.crit = 0.05, method=&quot;D3&quot;)</code></pre>
<pre><code>## Variable excluded at Step 1 is - JobControl</code></pre>
<pre><code>## Variable excluded at Step 2 is - JobDemands</code></pre>
<pre><code>## Variable excluded at Step 3 is - Smoking</code></pre>
<pre><code>## Variable excluded at Step 4 is - SocialSupport</code></pre>
<pre><code>## Variable excluded at Step 5 is - Gender</code></pre>
<pre class="r"><code>pool_lr$RR_Model</code></pre>
<pre><code>## $`Step 1`
##                   est std.err signif   lower   upper     OR   L.OR
## (Intercept)    1.1637  2.2828 0.6102 -3.3104  5.6379 3.2018 0.0365
## Gender        -0.4220  0.4073 0.3001 -1.2202  0.3762 0.6557 0.2952
## Smoking        0.1164  0.3407 0.7327 -0.5515  0.7842 1.1234 0.5761
## Function      -0.1457  0.0421 0.0005 -0.2282 -0.0632 0.8644 0.7959
## JobControl     0.0021  0.0191 0.9145 -0.0355  0.0396 1.0021 0.9652
## JobDemands    -0.0087  0.0357 0.8065 -0.0787  0.0612 0.9913 0.9243
## SocialSupport  0.0249  0.0540 0.6449 -0.0810  0.1308 1.0252 0.9222
##                   U.OR
## (Intercept)   280.8649
## Gender          1.4568
## Smoking         2.1907
## Function        0.9387
## JobControl      1.0404
## JobDemands      1.0632
## SocialSupport   1.1397
## 
## $`Step 2`
##                   est std.err signif   lower   upper     OR   L.OR
## (Intercept)    1.3088  1.8407 0.4770 -2.2988  4.9164 3.7019 0.1004
## Gender        -0.4296  0.4012 0.2843 -1.2158  0.3567 0.6508 0.2965
## Smoking        0.1173  0.3406 0.7305 -0.5502  0.7849 1.1245 0.5768
## Function      -0.1450  0.0415 0.0005 -0.2262 -0.0637 0.8651 0.7975
## JobDemands    -0.0089  0.0357 0.8019 -0.0788  0.0610 0.9911 0.9242
## SocialSupport  0.0239  0.0532 0.6532 -0.0804  0.1282 1.0242 0.9228
##                   U.OR
## (Intercept)   136.5169
## Gender          1.4286
## Smoking         2.1922
## Function        0.9383
## JobDemands      1.0628
## SocialSupport   1.1367
## 
## $`Step 3`
##                   est std.err signif   lower   upper     OR   L.OR    U.OR
## (Intercept)    0.9989  1.3631 0.4637 -1.6728  3.6705 2.7152 0.1877 39.2713
## Gender        -0.4128  0.3955 0.2966 -1.1880  0.3624 0.6618 0.3048  1.4367
## Smoking        0.1177  0.3406 0.7298 -0.5499  0.7852 1.1249 0.5770  2.1929
## Function      -0.1448  0.0414 0.0005 -0.2260 -0.0636 0.8652 0.7977  0.9384
## SocialSupport  0.0236  0.0532 0.6575 -0.0806  0.1278 1.0239 0.9225  1.1363
## 
## $`Step 4`
##                   est std.err signif   lower   upper     OR   L.OR    U.OR
## (Intercept)    1.0465  1.3564 0.4404 -1.6119  3.7050 2.8477 0.1995 40.6483
## Gender        -0.4113  0.3954 0.2982 -1.1861  0.3636 0.6628 0.3054  1.4385
## Function      -0.1432  0.0411 0.0005 -0.2237 -0.0627 0.8666 0.7996  0.9393
## SocialSupport  0.0231  0.0531 0.6644 -0.0811  0.1272 1.0233 0.9221  1.1356
## 
## $`Step 5`
##                 est std.err signif   lower   upper     OR   L.OR    U.OR
## (Intercept)  1.5889  0.5348 0.0030  0.5407  2.6371 4.8983 1.7172 13.9725
## Gender      -0.4196  0.3943 0.2872 -1.1924  0.3531 0.6573 0.3035  1.4235
## Function    -0.1430  0.0411 0.0005 -0.2235 -0.0625 0.8668 0.7997  0.9394
## 
## $`Step 6`
##                 est std.err signif   lower   upper     OR   L.OR   U.OR
## (Intercept)  1.3143  0.4622 0.0045  0.4084  2.2203 3.7222 1.5043 9.2097
## Function    -0.1471  0.0408 0.0003 -0.2272 -0.0671 0.8632 0.7968 0.9351</code></pre>
<pre class="r"><code>pool_lr$multiparm_p</code></pre>
<pre><code>## $`Step 1`
##               D3 p-values
## Gender             0.3001
## Smoking            0.7327
## Function           0.0005
## JobControl         0.9145
## JobDemands         0.8065
## SocialSupport      0.6449
## 
## $`Step 2`
##               D3 p-values
## Gender             0.2843
## Smoking            0.7305
## Function           0.0005
## JobDemands         0.8019
## SocialSupport      0.6532
## 
## $`Step 3`
##               D3 p-values
## Gender             0.2966
## Smoking            0.7298
## Function           0.0005
## SocialSupport      0.6575
## 
## $`Step 4`
##               D3 p-values
## Gender             0.2982
## Function           0.0005
## SocialSupport      0.6644
## 
## $`Step 5`
##          D3 p-values
## Gender        0.2872
## Function      0.0005
## 
## $`Step 6`
##          D3 p-values
## Function       3e-04</code></pre>
<p>Back to <a href="#examples">Examples</a></p>
</div>
</div>
