---
title: "Logistic Regression after Multiple Imputation - different selection criteria"
author: "Martijn Heymans"
date: '2019-01-02'
slug: backward-logistic-regression-after-multiple-imputation
output:
    blogdown::html_page
tags: ["psfmi", "Multiple Imputation", "backward selection"]
thumbnailImagePosition: left
thumbnailImage: "/images/different_selection_criteria.jpg"
description: With the [psfmi](https://mwheymans.github.io/psfmi/) package it is possible to do backward selection for logistic regression models after Multiple Imputation (MI). For backward selection, several variable selection criteria can be used. These criteria are called the D1, D2, D3 and Median P-rule (MPR).

---



<p>The different methods are described in the papers of <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/1471-2288-9-57">Marshall et al</a> and <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/s12874-017-0404-7">Eekhout, vd Wiel and Heymans</a>.</p>
<p>Be aware that backward selection may result in overfitted and optimistic prediction models, see <a href="http://annals.org/aim/fullarticle/2088542/transparent-reporting-multivariable-prediction-model-individual-prognosis-diagnosis-tripod-explanation">TRIPOD</a>. Backward selection should therefore be followed by internal validation of the model.</p>
<div id="examples" class="section level2">
<h2>Examples</h2>
<ul>
<li><a href="#pooling-without-bws-and-method-d1">Pooling without BWS and method D1</a></li>
<li><a href="#pooling-with-bws-and-method-d3">Pooling with BWS and method D3</a></li>
</ul>
</div>
<div id="logistic-regression" class="section level2">
<h2>Logistic Regression</h2>
<div id="pooling-without-bws-and-method-d1" class="section level3">
<h3>Pooling without BWS and method D1</h3>
<pre class="r"><code>library(psfmi)
pool_lr &lt;- psfmi_lr(data=lbpmilr, nimp=5, impvar=&quot;Impnr&quot;, Outcome=&quot;Chronic&quot;,
         predictors=c(&quot;Gender&quot;, &quot;Smoking&quot;, &quot;Function&quot;, &quot;JobControl&quot;,
                      &quot;JobDemands&quot;, &quot;SocialSupport&quot;), method=&quot;D1&quot;)</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;car&#39;:
##   method                          from
##   influence.merMod                lme4
##   cooks.distance.influence.merMod lme4
##   dfbeta.influence.merMod         lme4
##   dfbetas.influence.merMod        lme4</code></pre>
<pre><code>## 
## Pooled model correctly estimated
##            using a p-value of 1</code></pre>
<pre class="r"><code>pool_lr$RR_Model</code></pre>
<pre><code>## $`Step 1`
##                   est std.err signif   lower   upper     OR   L.OR     U.OR
## (Intercept)   -0.0215  2.4949 0.9931 -4.9246  4.8817 0.9788 0.0073 131.8530
## Gender        -0.3545  0.4181 0.3966 -1.1741  0.4652 0.7016 0.3091   1.5923
## Smoking        0.0757  0.3408 0.8244 -0.5924  0.7437 1.0786 0.5530   2.1037
## Function      -0.1419  0.0434 0.0011 -0.2270 -0.0568 0.8677 0.7969   0.9448
## JobControl     0.0069  0.0205 0.7370 -0.0335  0.0473 1.0069 0.9670   1.0485
## JobDemands     0.0023  0.0387 0.9532 -0.0738  0.0784 1.0023 0.9288   1.0815
## SocialSupport  0.0443  0.0575 0.4408 -0.0685  0.1572 1.0453 0.9338   1.1702</code></pre>
<pre class="r"><code>pool_lr$multiparm</code></pre>
<pre><code>## $`Step 1`
##               Chi_sq p-value D1 &amp; RR
## Gender         0.719          0.3966
## Smoking        0.049          0.8244
## Function      10.698          0.0011
## JobControl     0.113          0.7370
## JobDemands     0.003          0.9532
## SocialSupport  0.594          0.4408</code></pre>
<p>Back to <a href="#examples">Examples</a></p>
</div>
<div id="pooling-with-bws-and-method-d3" class="section level3">
<h3>Pooling with BWS and method D3</h3>
<p>Pooling Logistic regression models over 5 imputed datasets with backward selection
using a p-value of 0.05 and as method D3 (Meng and Rubin likelihood ratio statistics).</p>
<pre class="r"><code>library(psfmi)
pool_lr &lt;- psfmi_lr(data=lbpmilr, nimp=5, impvar=&quot;Impnr&quot;, Outcome=&quot;Chronic&quot;,
         predictors=c(&quot;Gender&quot;, &quot;Smoking&quot;, &quot;Function&quot;, &quot;JobControl&quot;,
                      &quot;JobDemands&quot;, &quot;SocialSupport&quot;), p.crit = 0.05, method=&quot;D3&quot;)</code></pre>
<pre><code>## Variable excluded at Step 1 is - JobDemands</code></pre>
<pre><code>## Variable excluded at Step 2 is - Smoking</code></pre>
<pre><code>## Variable excluded at Step 3 is - JobControl</code></pre>
<pre><code>## Variable excluded at Step 4 is - SocialSupport</code></pre>
<pre><code>## Variable excluded at Step 5 is - Gender</code></pre>
<pre class="r"><code>pool_lr$RR_Model</code></pre>
<pre><code>## $`Step 1`
##                   est std.err signif   lower   upper     OR   L.OR     U.OR
## (Intercept)   -0.0215  2.4949 0.9931 -4.9246  4.8817 0.9788 0.0073 131.8530
## Gender        -0.3545  0.4181 0.3966 -1.1741  0.4652 0.7016 0.3091   1.5923
## Smoking        0.0757  0.3408 0.8244 -0.5924  0.7437 1.0786 0.5530   2.1037
## Function      -0.1419  0.0434 0.0011 -0.2270 -0.0568 0.8677 0.7969   0.9448
## JobControl     0.0069  0.0205 0.7370 -0.0335  0.0473 1.0069 0.9670   1.0485
## JobDemands     0.0023  0.0387 0.9532 -0.0738  0.0784 1.0023 0.9288   1.0815
## SocialSupport  0.0443  0.0575 0.4408 -0.0685  0.1572 1.0453 0.9338   1.1702
## 
## $`Step 2`
##                   est std.err signif   lower   upper     OR   L.OR    U.OR
## (Intercept)    0.0664  1.9997 0.9735 -3.8606  3.9935 1.0687 0.0211 54.2427
## Gender        -0.3568  0.4099 0.3841 -1.1602  0.4467 0.6999 0.3134  1.5631
## Smoking        0.0746  0.3407 0.8266 -0.5931  0.7424 1.0775 0.5526  2.1009
## Function      -0.1420  0.0434 0.0011 -0.2271 -0.0569 0.8676 0.7969  0.9447
## JobControl     0.0068  0.0205 0.7397 -0.0336  0.0472 1.0068 0.9670  1.0483
## SocialSupport  0.0442  0.0574 0.4410 -0.0684  0.1569 1.0452 0.9339  1.1699
## 
## $`Step 3`
##                   est std.err signif   lower   upper     OR   L.OR    U.OR
## (Intercept)    0.0933  1.9957 0.9627 -3.8259  4.0125 1.0978 0.0218 55.2826
## Gender        -0.3554  0.4098 0.3858 -1.1587  0.4478 0.7009 0.3139  1.5649
## Function      -0.1412  0.0431 0.0011 -0.2257 -0.0567 0.8683 0.7980  0.9449
## JobControl     0.0069  0.0205 0.7358 -0.0334  0.0473 1.0069 0.9671  1.0484
## SocialSupport  0.0439  0.0574 0.4442 -0.0686  0.1565 1.0449 0.9337  1.1694
## 
## $`Step 4`
##                   est std.err signif   lower   upper     OR   L.OR    U.OR
## (Intercept)    0.5793  1.3846 0.6757 -2.1359  3.2945 1.7848 0.1181 26.9638
## Gender        -0.3903  0.3991 0.3281 -1.1726  0.3920 0.6769 0.3096  1.4800
## Function      -0.1378  0.0423 0.0012 -0.2209 -0.0547 0.8713 0.8018  0.9467
## SocialSupport  0.0398  0.0561 0.4781 -0.0702  0.1498 1.0406 0.9322  1.1616
## 
## $`Step 5`
##                 est std.err signif   lower   upper     OR   L.OR    U.OR
## (Intercept)  1.4947  0.5340 0.0051  0.4480  2.5414 4.4579 1.5651 12.6974
## Gender      -0.4112  0.3965 0.2997 -1.1884  0.3660 0.6629 0.3047  1.4420
## Function    -0.1354  0.0421 0.0013 -0.2181 -0.0528 0.8733 0.8041  0.9486
## 
## $`Step 6`
##                 est std.err signif   lower   upper     OR   L.OR   U.OR
## (Intercept)  1.2290  0.4696  9e-03  0.3079  2.1501 3.4178 1.3605 8.5858
## Function    -0.1399  0.0420  9e-04 -0.2222 -0.0575 0.8695 0.8007 0.9441</code></pre>
<pre class="r"><code>pool_lr$multiparm</code></pre>
<pre><code>## $`Step 1`
##               D3 p-values
## Gender             0.3966
## Smoking            0.8244
## Function           0.0011
## JobControl         0.7370
## JobDemands         0.9532
## SocialSupport      0.4408
## 
## $`Step 2`
##               D3 p-values
## Gender             0.3841
## Smoking            0.8266
## Function           0.0011
## JobControl         0.7397
## SocialSupport      0.4410
## 
## $`Step 3`
##               D3 p-values
## Gender             0.3858
## Function           0.0011
## JobControl         0.7358
## SocialSupport      0.4442
## 
## $`Step 4`
##               D3 p-values
## Gender             0.3281
## Function           0.0012
## SocialSupport      0.4781
## 
## $`Step 5`
##          D3 p-values
## Gender        0.2997
## Function      0.0013
## 
## $`Step 6`
##          D3 p-values
## Function       9e-04</code></pre>
<p>Back to <a href="#examples">Examples</a></p>
</div>
</div>
